!function(t){"use strict";function e(e){var i=this.viewer.viewport.deltaPointsFromPixels(e.delta,!0);if(!this.rect||this.startNew){this.startNew=!1;var n=new t.Point(e.position.x-e.delta.x,e.position.y-e.delta.y);n=this.viewer.viewport.pointFromPixel(n,!0),this.rect=new t.SelectionRect(n.x,n.y,i.x,i.y)}else this.rect.width+=i.x,this.rect.height+=i.y;this.draw()}function i(){this.startNew=!0}function n(e){t.addClass(this.element,"dragging");var i=this.viewer.viewport.deltaPointsFromPixels(e.delta,!0);this.rect.x+=i.x,this.rect.y+=i.y,this.draw()}function r(){t.removeClass(this.element,"dragging")}function o(t){var e=t.keyCode?t.keyCode:t.charCode;13===e?(this.viewer.raiseEvent("selection",s(this.rect)),this.undraw()):String.fromCharCode(e)===this.keyboardShortcut&&this.toggleState()}function s(e){var i=new t.SelectionRect(e.x,e.y,e.width,e.height);return i.width<0&&(i.x+=i.width,i.width*=-1),i.height<0&&(i.y+=i.height,i.height*=-1),i}if(!t.version||t.version.major<2)throw new Error("This version of OpenSeadragonSelection requires OpenSeadragon version 2.0.0+");t.Viewer.prototype.selection=function(e){this.selectionInstance?this.selectionInstance.refresh(e):(e=e||{},e.viewer=this,this.selectionInstance=new t.Selection(e))},t.Selection=function(s){t.extend(!0,this,{viewer:null,element:null,showSelectionControl:!0,keyboardShortcut:"c",onSelection:function(){},isSelecting:!1,rect:null,startNew:!0},s),this.element||(this.element=t.makeNeutralElement("div"),this.element.style.background="#000"),this.overlay||(this.overlay=new t.SelectionOverlay(this.element,this.rect||new t.SelectionRect)),this.outerTracker=new t.MouseTracker({element:this.viewer.drawer.canvas,dragHandler:t.delegate(this,e),dragEndHandler:t.delegate(this,i),keyHandler:t.delegate(this,o),startDisabled:!this.isSelecting}),this.innerTracker=new t.MouseTracker({element:this.element,dragHandler:t.delegate(this,n),dragEndHandler:t.delegate(this,r)}),this.keyboardShortcut&&t.addEvent(this.viewer.container,"keypress",t.delegate(this,o),!1),this.showSelectionControl,this.viewer.addHandler("selection",this.onSelection)},t.Selection.prototype={toggleState:function(){t.console.log("onSelectionToggle"),this.isSelecting?this.disable():this.enable()},enable:function(){this.isSelecting=!0,this.outerTracker.setTracking(!0),this.undraw()},disable:function(){this.isSelecting=!1,this.outerTracker.setTracking(!1),this.undraw()},draw:function(){this.overlay.update(s(this.rect)),this.overlay.drawHTML(this.viewer.container,this.viewer.viewport)},undraw:function(){this.overlay.destroy(),this.rect=null}}}(OpenSeadragon),function(t){"use strict";t.SelectionOverlay=function(e,i){t.Overlay.apply(this,arguments),t.isPlainObject(e)?this.rotation=e.location.rotation||0:this.rotation=i.rotation||0},t.SelectionOverlay.prototype=t.extend(Object.create(t.Overlay.prototype),{drawHTML:function(){t.Overlay.prototype.drawHTML.apply(this,arguments),this.style.transform=this.style.transform.replace(/ ?rotate\(.+rad\)/,"")+" rotate("+this.rotation+"rad)"},update:function(e){t.Overlay.prototype.update.apply(this,arguments),this.rotation=e.rotation||0}})}(OpenSeadragon),function(t){"use strict";t.SelectionRect=function(e,i,n,r,o){t.Rect.apply(this,[e,i,n,r]),this.rotation=o||0},t.SelectionRect.prototype=t.extend(Object.create(t.Rect.prototype),{clone:function(){return new t.SelectionRect(this.x,this.y,this.width,this.height,this.rotation)},equals:function(e){return t.Rect.prototype.equals.apply(this,[e])&&this.rotation===e.rotation},toString:function(){return"["+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+","+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+"@"+Math.round(100*this.rotation)/100+"]"}})}(OpenSeadragon);
//# sourceMappingURL=openseadragonselection.js.map

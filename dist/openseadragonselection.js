!function(e){"use strict";function t(t){var i=this.viewer.viewport.deltaPointsFromPixels(t.delta,!0);if(!this.rect||this.startNew){this.startNew=!1;var n=new e.Point(t.position.x-t.delta.x,t.position.y-t.delta.y);n=this.viewer.viewport.pointFromPixel(n,!0),this.rect=new e.SelectionRect(n.x,n.y,i.x,i.y),this.viewer.addOverlay(this.element,o(this.rect))}else this.rect.width+=i.x,this.rect.height+=i.y,this.viewer.updateOverlay(this.element,o(this.rect))}function i(){this.startNew=!0}function n(e){-1===this.element.className.indexOf(" dragging ")&&(this.element.className+=" dragging ");var t=this.viewer.viewport.deltaPointsFromPixels(e.delta,!0);this.rect.x+=t.x,this.rect.y+=t.y,this.viewer.updateOverlay(this.element,o(this.rect))}function r(){this.element.className=this.element.className.replace(" dragging ","")}function s(e){var t=e.keyCode?e.keyCode:e.charCode;13===t?(this.viewer.raiseEvent("selection",o(this.rect)),this.viewer.removeOverlay(this.element)):String.fromCharCode(t)===this.keyboardShortcut&&this.toggleState()}function o(t){var i=new e.Rect(t.x,t.y,t.width,t.height);return i.width<0&&(i.x+=i.width,i.width*=-1),i.height<0&&(i.y+=i.height,i.height*=-1),i}if(!e.version||e.version.major<2)throw new Error("This version of OpenSeadragonSelection requires OpenSeadragon version 2.0.0+");e.Viewer.prototype.selection=function(t){this.selectionInstance?this.selectionInstance.refresh(t):(t=t||{},t.viewer=this,this.selectionInstance=new e.Selection(t))},e.Selection=function(o){e.extend(!0,this,{viewer:null,element:null,showSelectionControl:!0,keyboardShortcut:"c",onSelection:function(){},isSelecting:!1,rect:null,startNew:!0},o),this.element||(this.element=e.makeNeutralElement("div"),this.element.style.background="#000"),this.outerTracker=new e.MouseTracker({element:this.viewer.drawer.canvas,dragHandler:e.delegate(this,t),dragEndHandler:e.delegate(this,i),keyHandler:e.delegate(this,s),startDisabled:!this.isSelecting}),this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,n),dragEndHandler:e.delegate(this,r)}),this.keyboardShortcut&&e.addEvent(this.viewer.container,"keypress",e.delegate(this,s),!1),this.showSelectionControl,this.viewer.addHandler("selection",this.onSelection)},e.Selection.prototype={toggleState:function(){e.console.log("onSelectionToggle"),this.isSelecting?this.disable():this.enable()},enable:function(){this.isSelecting=!0,this.outerTracker.setTracking(!0),this.viewer.removeOverlay(this.element),this.rect=null},disable:function(){this.isSelecting=!1,this.outerTracker.setTracking(!1),this.viewer.removeOverlay(this.element),this.rect=null}}}(OpenSeadragon),function(e){"use strict";e.SelectionOverlay=function(){e.Overlay.apply(this,arguments)},e.extend(e.SelectionOverlay.prototype,e.Overlay.prototype,{drawHTML:function(){e.Overlay.prototype.drawHTML.apply(this,arguments),this.style.background="red"}})}(OpenSeadragon),function(e){"use strict";e.SelectionRect=function(t,i,n,r,s){e.Rect.apply(this,[t,i,n,r]),this.rotation=s||0},e.extend(e.SelectionRect.prototype,e.Rect.prototype,{clone:function(){return new e.SelectionRect(this.x,this.y,this.width,this.height,this.rotation)},equals:function(t){return e.Rect.prototype.equals.apply(this,[t])&&this.rotation===t.rotation},toString:function(){return"["+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+","+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+"@"+Math.round(100*this.rotation)/100+"]"}})}(OpenSeadragon);
//# sourceMappingURL=openseadragonselection.js.map
